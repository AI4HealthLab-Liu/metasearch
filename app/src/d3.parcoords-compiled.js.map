{"version":3,"sources":["d3.parcoords.js"],"names":[],"mappings":"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","file":"d3.parcoords-compiled.js","sourcesContent":["d3.parcoords = function(config) {\n  var __ = {\n    data: [],\n    highlighted: [],\n    dimensions: {},\n    dimensionTitleRotation: 0,\n    brushed: false,\n    brushedColor: null,\n    alphaOnBrushed: 0.0,\n    mode: \"default\",\n    rate: 20,\n    width: 600,\n    height: 300,\n    margin: { top: 24, right: 0, bottom: 12, left: 0 },\n    nullValueSeparator: \"undefined\", // set to \"top\" or \"bottom\"\n    nullValueSeparatorPadding: { top: 8, right: 0, bottom: 8, left: 0 },\n    color: \"#069\",\n    composite: \"source-over\",\n    alpha: 0.7,\n    bundlingStrength: 0.5,\n    bundleDimension: null,\n    smoothness: 0.0,\n    showControlPoints: false,\n    hideAxis : [],\n    flipAxes: [],\n    animationTime: 1100, // How long it takes to flip the axis when you double click\n    rotateLabels: false\n  };\n\n  extend(__, config);\n\n  if (config && config.dimensionTitles) {\n    console.warn(\"dimensionTitles passed in config is deprecated. Add title to dimension object.\");\n    d3.entries(config.dimensionTitles).forEach(function(d) {\n      if (__.dimensions[d.key]) {\n        __.dimensions[d.key].title = __.dimensions[d.key].title ? __.dimensions[d.key].title : d.value;\n      } else {\n        __.dimensions[d.key] = {\n          title: d.value\n        };\n      }\n    });\n  }\nvar pc = function(selection) {\n  selection = pc.selection = d3.select(selection);\n\n  __.width = selection[0][0].clientWidth;\n  __.height = selection[0][0].clientHeight;\n\n  // canvas data layers\n  [\"marks\", \"foreground\", \"brushed\", \"highlight\"].forEach(function(layer) {\n    canvas[layer] = selection\n      .append(\"canvas\")\n      .attr(\"class\", layer)[0][0];\n    ctx[layer] = canvas[layer].getContext(\"2d\");\n  });\n\n  // svg tick and brush layers\n  pc.svg = selection\n    .append(\"svg\")\n      .attr(\"width\", __.width)\n      .attr(\"height\", __.height)\n      .style(\"font\", \"14px sans-serif\")\n      .style(\"position\", \"absolute\")\n\n    .append(\"svg:g\")\n      .attr(\"transform\", \"translate(\" + __.margin.left + \",\" + __.margin.top + \")\");\n\n  return pc;\n};\nvar events = d3.dispatch.apply(this,[\"render\", \"resize\", \"highlight\", \"brush\", \"brushend\", \"brushstart\", \"axesreorder\"].concat(d3.keys(__))),\n    w = function() { return __.width - __.margin.right - __.margin.left; },\n    h = function() { return __.height - __.margin.top - __.margin.bottom; },\n    flags = {\n      brushable: false,\n      reorderable: false,\n      axes: false,\n      interactive: false,\n      debug: false\n    },\n    xscale = d3.scale.ordinal(),\n    dragging = {},\n    line = d3.svg.line(),\n    axis = d3.svg.axis().orient(\"left\").ticks(5),\n    g, // groups for axes, brushes\n    ctx = {},\n    canvas = {},\n    clusterCentroids = [];\n\n// side effects for setters\nvar side_effects = d3.dispatch.apply(this,d3.keys(__))\n  .on(\"composite\", function(d) {\n    ctx.foreground.globalCompositeOperation = d.value;\n    ctx.brushed.globalCompositeOperation = d.value;\n  })\n  .on(\"alpha\", function(d) {\n    ctx.foreground.globalAlpha = d.value;\n    ctx.brushed.globalAlpha = d.value;\n  })\n  .on(\"brushedColor\", function (d) {\n    ctx.brushed.strokeStyle = d.value;\n  })\n  .on(\"width\", function(d) { pc.resize(); })\n  .on(\"height\", function(d) { pc.resize(); })\n  .on(\"margin\", function(d) { pc.resize(); })\n  .on(\"rate\", function(d) {\n    brushedQueue.rate(d.value);\n    foregroundQueue.rate(d.value);\n  })\n  .on(\"dimensions\", function(d) {\n    __.dimensions = pc.applyDimensionDefaults(d3.keys(d.value));\n    xscale.domain(pc.getOrderedDimensionKeys());\n    pc.sortDimensions();\n    if (flags.interactive){pc.render().updateAxes();}\n  })\n  .on(\"bundleDimension\", function(d) {\n      if (!d3.keys(__.dimensions).length) pc.detectDimensions();\n      pc.autoscale();\n      if (typeof d.value === \"number\") {\n          if (d.value < d3.keys(__.dimensions).length) {\n              __.bundleDimension = __.dimensions[d.value];\n          } else if (d.value < __.hideAxis.length) {\n              __.bundleDimension = __.hideAxis[d.value];\n          }\n      } else {\n          __.bundleDimension = d.value;\n      }\n\n      __.clusterCentroids = compute_cluster_centroids(__.bundleDimension);\n    if (flags.interactive){pc.render();}\n  })\n  .on(\"hideAxis\", function(d) {\n    pc.dimensions(pc.applyDimensionDefaults());\n    pc.dimensions(without(__.dimensions, d.value));\n  })\n  .on(\"flipAxes\", function(d) {\n    if (d.value && d.value.length) {\n        d.value.forEach(function(axis) {\n            flipAxisAndUpdatePCP(axis);\n        });\n        pc.updateAxes(0);\n    }\n  });\n\n// expose the state of the chart\npc.state = __;\npc.flags = flags;\n\n// create getter/setters\ngetset(pc, __, events);\n\n// expose events\nd3.rebind(pc, events, \"on\");\n\n// getter/setter with event firing\nfunction getset(obj,state,events)  {\n  d3.keys(state).forEach(function(key) {\n      obj[key] = function(x) {\n        if (!arguments.length) {\n          return state[key];\n        }\n        if (key === 'dimensions' && Object.prototype.toString.call(x) === '[object Array]') {\n          console.warn(\"pc.dimensions([]) is deprecated, use pc.dimensions({})\");\n          x = pc.applyDimensionDefaults(x);\n        }\n        var old = state[key];\n        state[key] = x;\n        side_effects[key].call(pc,{\"value\": x, \"previous\": old});\n        events[key].call(pc,{\"value\": x, \"previous\": old});\n        return obj;\n      };\n  });\n};\n\nfunction extend(target, source) {\n  for (var key in source) {\n    target[key] = source[key];\n  }\n  return target;\n};\n\nfunction without(arr, items) {\n  items.forEach(function (el) {\n    delete arr[el];\n  });\n  return arr;\n};\n/** adjusts an axis' default range [h()+1, 1] if a NullValueSeparator is set */\nfunction getRange() {\n\tif (__.nullValueSeparator==\"bottom\") {\n\t\treturn [h()+1-__.nullValueSeparatorPadding.bottom-__.nullValueSeparatorPadding.top, 1];\n\t} else if (__.nullValueSeparator==\"top\") {\n\t\treturn [h()+1, 1+__.nullValueSeparatorPadding.bottom+__.nullValueSeparatorPadding.top];\n\t}\n\treturn [h()+1, 1];\n};\n\npc.autoscale = function() {\n  // yscale\n  var defaultScales = {\n    \"date\": function(k) {\n      var extent = d3.extent(__.data, function(d) {\n        return d[k] ? d[k].getTime() : null;\n      });\n\n      // special case if single value\n      if (extent[0] === extent[1]) {\n        return d3.scale.ordinal()\n          .domain([extent[0]])\n          .rangePoints(getRange());\n      }\n\n      return d3.time.scale()\n        .domain(extent)\n        .range(getRange());\n    },\n    \"number\": function(k) {\n      var extent = d3.extent(__.data, function(d) { return +d[k]; });\n\n      // special case if single value\n      if (extent[0] === extent[1]) {\n        return d3.scale.ordinal()\n          .domain([extent[0]])\n          .rangePoints(getRange());\n      }\n\n      return d3.scale.linear()\n        .domain(extent)\n        .range(getRange());\n    },\n    \"string\": function(k) {\n      var counts = {},\n          domain = [];\n\n      // Let's get the count for each value so that we can sort the domain based\n      // on the number of items for each value.\n      __.data.map(function(p) {\n        if (p[k] === undefined && __.nullValueSeparator!== \"undefined\"){\n          return; // null values will be drawn beyond the horizontal null value separator!\n        }\n        if (counts[p[k]] === undefined) {\n          counts[p[k]] = 1;\n        } else {\n          counts[p[k]] = counts[p[k]] + 1;\n        }\n      });\n\n      domain = Object.getOwnPropertyNames(counts).sort(function(a, b) {\n        return counts[a] - counts[b];\n      });\n\n      return d3.scale.ordinal()\n        .domain(domain)\n        .rangePoints(getRange());\n    }\n  };\n\n  d3.keys(__.dimensions).forEach(function(k) {\n    if (!__.dimensions[k].yscale){\n      __.dimensions[k].yscale = defaultScales[__.dimensions[k].type](k);\n    }\n  });\n\n  // xscale\n  xscale.rangePoints([0, w()], 1);\n\n  // Retina display, etc.\n  var devicePixelRatio = window.devicePixelRatio || 1;\n\n  // canvas sizes\n  pc.selection.selectAll(\"canvas\")\n      .style(\"margin-top\", __.margin.top + \"px\")\n      .style(\"margin-left\", __.margin.left + \"px\")\n      .style(\"width\", (w()+2) + \"px\")\n      .style(\"height\", (h()+2) + \"px\")\n      .attr(\"width\", (w()+2) * devicePixelRatio)\n      .attr(\"height\", (h()+2) * devicePixelRatio);\n\n  // default styles, needs to be set when canvas width changes\n  ctx.foreground.strokeStyle = __.color;\n  ctx.foreground.lineWidth = 1.4;\n  ctx.foreground.globalCompositeOperation = __.composite;\n  ctx.foreground.globalAlpha = __.alpha;\n  ctx.foreground.scale(devicePixelRatio, devicePixelRatio);\n  ctx.brushed.strokeStyle = __.brushedColor;\n  ctx.brushed.lineWidth = 1.4;\n  ctx.brushed.globalCompositeOperation = __.composite;\n  ctx.brushed.globalAlpha = __.alpha;\n  ctx.brushed.scale(devicePixelRatio, devicePixelRatio);\n  ctx.highlight.lineWidth = 3;\n  ctx.highlight.scale(devicePixelRatio, devicePixelRatio);\n\n  return this;\n};\n\npc.scale = function(d, domain) {\n  __.dimensions[d].yscale.domain(domain);\n\n  return this;\n};\n\npc.flip = function(d) {\n  //__.dimensions[d].yscale.domain().reverse();                               // does not work\n  __.dimensions[d].yscale.domain(__.dimensions[d].yscale.domain().reverse()); // works\n\n  return this;\n};\n\npc.commonScale = function(global, type) {\n  var t = type || \"number\";\n  if (typeof global === 'undefined') {\n    global = true;\n  }\n\n  // try to autodetect dimensions and create scales\n  if (!d3.keys(__.dimensions).length) {\n    pc.detectDimensions()\n  }\n  pc.autoscale();\n\n  // scales of the same type\n  var scales = d3.keys(__.dimensions).filter(function(p) {\n    return __.dimensions[p].type == t;\n  });\n\n  if (global) {\n    var extent = d3.extent(scales.map(function(d,i) {\n      return __.dimensions[d].yscale.domain();\n    }).reduce(function(a,b) {\n      return a.concat(b);\n    }));\n\n    scales.forEach(function(d) {\n      __.dimensions[d].yscale.domain(extent);\n    });\n\n  } else {\n    scales.forEach(function(d) {\n      __.dimensions[d].yscale.domain(d3.extent(__.data, function(d) { return +d[k]; }));\n    });\n  }\n\n  // update centroids\n  if (__.bundleDimension !== null) {\n    pc.bundleDimension(__.bundleDimension);\n  }\n\n  return this;\n};\npc.detectDimensions = function() {\n  pc.dimensions(pc.applyDimensionDefaults());\n  return this;\n};\n\npc.applyDimensionDefaults = function(dims) {\n  var types = pc.detectDimensionTypes(__.data);\n  dims = dims ? dims : d3.keys(types);\n  var newDims = {};\n  var currIndex = 0;\n  dims.forEach(function(k) {\n    newDims[k] = __.dimensions[k] ? __.dimensions[k] : {};\n    //Set up defaults\n    newDims[k].orient= newDims[k].orient ? newDims[k].orient : 'left';\n    newDims[k].ticks= newDims[k].ticks != null ? newDims[k].ticks : 5;\n    newDims[k].innerTickSize= newDims[k].innerTickSize != null ? newDims[k].innerTickSize : 6;\n    newDims[k].outerTickSize= newDims[k].outerTickSize != null ? newDims[k].outerTickSize : 0;\n    newDims[k].tickPadding= newDims[k].tickPadding != null ? newDims[k].tickPadding : 3;\n    newDims[k].type= newDims[k].type ? newDims[k].type : types[k];\n\n    newDims[k].index = newDims[k].index != null ? newDims[k].index : currIndex;\n    currIndex++;\n  });\n  return newDims;\n};\n\npc.getOrderedDimensionKeys = function(){\n  return d3.keys(__.dimensions).sort(function(x, y){\n    return d3.ascending(__.dimensions[x].index, __.dimensions[y].index);\n  });\n};\n\n// a better \"typeof\" from this post: http://stackoverflow.com/questions/7390426/better-way-to-get-type-of-a-javascript-variable\npc.toType = function(v) {\n  return ({}).toString.call(v).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();\n};\n\n// try to coerce to number before returning type\npc.toTypeCoerceNumbers = function(v) {\n  if ((parseFloat(v) == v) && (v != null)) {\n    return \"number\";\n  }\n  return pc.toType(v);\n};\n\n// attempt to determine types of each dimension based on first row of data\npc.detectDimensionTypes = function(data) {\n  var types = {};\n  d3.keys(data[0])\n    .forEach(function(col) {\n      types[isNaN(Number(col)) ? col : parseInt(col)] = pc.toTypeCoerceNumbers(data[0][col]);\n    });\n  return types;\n};\npc.render = function() {\n  // try to autodetect dimensions and create scales\n  if (!d3.keys(__.dimensions).length) {\n    pc.detectDimensions()\n  }\n  pc.autoscale();\n\n  pc.render[__.mode]();\n\n  events.render.call(this);\n  return this;\n};\n\npc.renderBrushed = function() {\n  if (!d3.keys(__.dimensions).length) pc.detectDimensions();\n\n  pc.renderBrushed[__.mode]();\n\n  events.render.call(this);\n  return this;\n};\n\nfunction isBrushed() {\n  if (__.brushed && __.brushed.length !== __.data.length)\n    return true;\n\n  var object = brush.currentMode().brushState();\n\n  for (var key in object) {\n    if (object.hasOwnProperty(key)) {\n      return true;\n    }\n  }\n  return false;\n};\n\npc.render.default = function() {\n  pc.clear('foreground');\n  pc.clear('highlight');\n\n  pc.renderBrushed.default();\n\n  __.data.forEach(path_foreground);\n};\n\nvar foregroundQueue = d3.renderQueue(path_foreground)\n  .rate(50)\n  .clear(function() {\n    pc.clear('foreground');\n    pc.clear('highlight');\n  });\n\npc.render.queue = function() {\n  pc.renderBrushed.queue();\n\n  foregroundQueue(__.data);\n};\n\npc.renderBrushed.default = function() {\n  pc.clear('brushed');\n\n  if (isBrushed()) {\n    __.brushed.forEach(path_brushed);\n  }\n};\n\nvar brushedQueue = d3.renderQueue(path_brushed)\n  .rate(50)\n  .clear(function() {\n    pc.clear('brushed');\n  });\n\npc.renderBrushed.queue = function() {\n  if (isBrushed()) {\n    brushedQueue(__.brushed);\n  } else {\n    brushedQueue([]); // This is needed to clear the currently brushed items\n  }\n};\nfunction compute_cluster_centroids(d) {\n\n\tvar clusterCentroids = d3.map();\n\tvar clusterCounts = d3.map();\n\t// determine clusterCounts\n\t__.data.forEach(function(row) {\n\t\tvar scaled = __.dimensions[d].yscale(row[d]);\n\t\tif (!clusterCounts.has(scaled)) {\n\t\t\tclusterCounts.set(scaled, 0);\n\t\t}\n\t\tvar count = clusterCounts.get(scaled);\n\t\tclusterCounts.set(scaled, count + 1);\n\t});\n\n\t__.data.forEach(function(row) {\n\t\td3.keys(__.dimensions).map(function(p, i) {\n\t\t\tvar scaled = __.dimensions[d].yscale(row[d]);\n\t\t\tif (!clusterCentroids.has(scaled)) {\n\t\t\t\tvar map = d3.map();\n\t\t\t\tclusterCentroids.set(scaled, map);\n\t\t\t}\n\t\t\tif (!clusterCentroids.get(scaled).has(p)) {\n\t\t\t\tclusterCentroids.get(scaled).set(p, 0);\n\t\t\t}\n\t\t\tvar value = clusterCentroids.get(scaled).get(p);\n\t\t\tvalue += __.dimensions[p].yscale(row[p]) / clusterCounts.get(scaled);\n\t\t\tclusterCentroids.get(scaled).set(p, value);\n\t\t});\n\t});\n\n\treturn clusterCentroids;\n\n}\n\nfunction compute_centroids(row) {\n\tvar centroids = [];\n\n\tvar p = d3.keys(__.dimensions);\n\tvar cols = p.length;\n\tvar a = 0.5;\t\t\t// center between axes\n\tfor (var i = 0; i < cols; ++i) {\n\t\t// centroids on 'real' axes\n\t\tvar x = position(p[i]);\n\t\tvar y = __.dimensions[p[i]].yscale(row[p[i]]);\n\t\tcentroids.push($V([x, y]));\n\n\t\t// centroids on 'virtual' axes\n\t\tif (i < cols - 1) {\n\t\t\tvar cx = x + a * (position(p[i+1]) - x);\n\t\t\tvar cy = y + a * (__.dimensions[p[i+1]].yscale(row[p[i+1]]) - y);\n\t\t\tif (__.bundleDimension !== null) {\n\t\t\t\tvar leftCentroid = __.clusterCentroids.get(__.dimensions[__.bundleDimension].yscale(row[__.bundleDimension])).get(p[i]);\n\t\t\t\tvar rightCentroid = __.clusterCentroids.get(__.dimensions[__.bundleDimension].yscale(row[__.bundleDimension])).get(p[i+1]);\n\t\t\t\tvar centroid = 0.5 * (leftCentroid + rightCentroid);\n\t\t\t\tcy = centroid + (1 - __.bundlingStrength) * (cy - centroid);\n\t\t\t}\n\t\t\tcentroids.push($V([cx, cy]));\n\t\t}\n\t}\n\n\treturn centroids;\n}\n\npc.compute_real_centroids = function(row) {\n\tvar realCentroids = [];\n\n\tvar p = d3.keys(__.dimensions);\n\tvar cols = p.length;\n\tvar a = 0.5;\n\n\tfor (var i = 0; i < cols; ++i) {\n\t\tvar x = position(p[i]);\n\t\tvar y = __.dimensions[p[i]].yscale(row[p[i]]);\n\t\trealCentroids.push([x, y]);\n\t}\n\n\treturn realCentroids;\n}\n\nfunction compute_control_points(centroids) {\n\n\tvar cols = centroids.length;\n\tvar a = __.smoothness;\n\tvar cps = [];\n\n\tcps.push(centroids[0]);\n\tcps.push($V([centroids[0].e(1) + a*2*(centroids[1].e(1)-centroids[0].e(1)), centroids[0].e(2)]));\n\tfor (var col = 1; col < cols - 1; ++col) {\n\t\tvar mid = centroids[col];\n\t\tvar left = centroids[col - 1];\n\t\tvar right = centroids[col + 1];\n\n\t\tvar diff = left.subtract(right);\n\t\tcps.push(mid.add(diff.x(a)));\n\t\tcps.push(mid);\n\t\tcps.push(mid.subtract(diff.x(a)));\n\t}\n\tcps.push($V([centroids[cols-1].e(1) + a*2*(centroids[cols-2].e(1)-centroids[cols-1].e(1)), centroids[cols-1].e(2)]));\n\tcps.push(centroids[cols - 1]);\n\n\treturn cps;\n\n};pc.shadows = function() {\n\tflags.shadows = true;\n\tpc.alphaOnBrushed(0.1);\n\tpc.render();\n\treturn this;\n};\n\n// draw dots with radius r on the axis line where data intersects\npc.axisDots = function(r) {\n\tvar r = r || 0.1;\n\tvar ctx = pc.ctx.marks;\n\tvar startAngle = 0;\n\tvar endAngle = 2 * Math.PI;\n\tctx.globalAlpha = d3.min([ 1 / Math.pow(__.data.length, 1 / 2), 1 ]);\n\t__.data.forEach(function(d) {\n\t\td3.entries(__.dimensions).forEach(function(p, i) {\n\t\t\tctx.beginPath();\n\t\t\tctx.arc(position(p), __.dimensions[p.key].yscale(d[p]), r, startAngle, endAngle);\n\t\t\tctx.stroke();\n\t\t\tctx.fill();\n\t\t});\n\t});\n\treturn this;\n};\n\n// draw single cubic bezier curve\nfunction single_curve(d, ctx) {\n\n\tvar centroids = compute_centroids(d);\n\tvar cps = compute_control_points(centroids);\n\n\tctx.moveTo(cps[0].e(1), cps[0].e(2));\n\tfor (var i = 1; i < cps.length; i += 3) {\n\t\tif (__.showControlPoints) {\n\t\t\tfor (var j = 0; j < 3; j++) {\n\t\t\t\tctx.fillRect(cps[i+j].e(1), cps[i+j].e(2), 2, 2);\n\t\t\t}\n\t\t}\n\t\tctx.bezierCurveTo(cps[i].e(1), cps[i].e(2), cps[i+1].e(1), cps[i+1].e(2), cps[i+2].e(1), cps[i+2].e(2));\n\t}\n};\n\n// draw single polyline\nfunction color_path(d, ctx) {\n\tctx.beginPath();\n\tif ((__.bundleDimension !== null && __.bundlingStrength > 0) || __.smoothness > 0) {\n\t\tsingle_curve(d, ctx);\n\t} else {\n\t\tsingle_path(d, ctx);\n\t}\n\tctx.stroke();\n};\n\n// draw many polylines of the same color\nfunction paths(data, ctx) {\n\tctx.clearRect(-1, -1, w() + 2, h() + 2);\n\tctx.beginPath();\n\tdata.forEach(function(d) {\n\t\tif ((__.bundleDimension !== null && __.bundlingStrength > 0) || __.smoothness > 0) {\n\t\t\tsingle_curve(d, ctx);\n\t\t} else {\n\t\t\tsingle_path(d, ctx);\n\t\t}\n\t});\n\tctx.stroke();\n};\n\n// returns the y-position just beyond the separating null value line\nfunction getNullPosition() {\n\tif (__.nullValueSeparator==\"bottom\") {\n\t\treturn h()+1;\n\t} else if (__.nullValueSeparator==\"top\") {\n\t\treturn 1;\n\t} else {\n\t\tconsole.log(\"A value is NULL, but nullValueSeparator is not set; set it to 'bottom' or 'top'.\");\n\t}\n\treturn h()+1;\n};\n\nfunction single_path(d, ctx) {\n\td3.entries(__.dimensions).forEach(function(p, i) {  //p isn't really p\n\t\tif (i == 0) {\n\t\t\tctx.moveTo(position(p.key), typeof d[p.key] =='undefined' ? getNullPosition() : __.dimensions[p.key].yscale(d[p.key]));\n\t\t} else {\n\t\t\tctx.lineTo(position(p.key), typeof d[p.key] =='undefined' ? getNullPosition() : __.dimensions[p.key].yscale(d[p.key]));\n\t\t}\n\t});\n};\n\nfunction path_brushed(d, i) {\n  if (__.brushedColor !== null) {\n    ctx.brushed.strokeStyle = d3.functor(__.brushedColor)(d, i);\n  } else {\n    ctx.brushed.strokeStyle = d3.functor(__.color)(d, i);\n  }\n  return color_path(d, ctx.brushed)\n};\n\nfunction path_foreground(d, i) {\n  ctx.foreground.strokeStyle = d3.functor(__.color)(d, i);\n\treturn color_path(d, ctx.foreground);\n};\n\nfunction path_highlight(d, i) {\n  ctx.highlight.strokeStyle = d3.functor(__.color)(d, i);\n\treturn color_path(d, ctx.highlight);\n};\npc.clear = function(layer) {\n  ctx[layer].clearRect(0, 0, w() + 2, h() + 2);\n\n  // This will make sure that the foreground items are transparent\n  // without the need for changing the opacity style of the foreground canvas\n  // as this would stop the css styling from working\n  if(layer === \"brushed\" && isBrushed()) {\n    ctx.brushed.fillStyle = pc.selection.style(\"background-color\");\n    ctx.brushed.globalAlpha = 1 - __.alphaOnBrushed;\n    ctx.brushed.fillRect(0, 0, w() + 2, h() + 2);\n    ctx.brushed.globalAlpha = __.alpha;\n  }\n  return this;\n};\nd3.rebind(pc, axis, \"ticks\", \"orient\", \"tickValues\", \"tickSubdivide\", \"tickSize\", \"tickPadding\", \"tickFormat\");\n\nfunction flipAxisAndUpdatePCP(dimension) {\n  var g = pc.svg.selectAll(\".dimension\");\n\n  pc.flip(dimension);\n\n  d3.select(this.parentElement)\n    .transition()\n      .duration(__.animationTime)\n      .call(axis.scale(__.dimensions[dimension].yscale))\n      .call(axis.orient(__.dimensions[dimension].orient))\n      .call(axis.ticks(__.dimensions[dimension].ticks))\n      .call(axis.innerTickSize(__.dimensions[dimension].innerTickSize))\n      .call(axis.outerTickSize(__.dimensions[dimension].outerTickSize))\n      .call(axis.tickPadding(__.dimensions[dimension].tickPadding))\n      .call(axis.tickFormat(__.dimensions[dimension].tickFormat));\n\n  pc.render();\n}\n\nfunction rotateLabels() {\n  if (!__.rotateLabels) return;\n  \n  var delta = d3.event.deltaY;\n  delta = delta < 0 ? -5 : delta;\n  delta = delta > 0 ? 5 : delta;\n\n  __.dimensionTitleRotation += delta;\n  pc.svg.selectAll(\"text.label\")\n    .attr(\"transform\", \"translate(0,-5) rotate(\" + __.dimensionTitleRotation + \")\");\n  d3.event.preventDefault();\n}\n\nfunction dimensionLabels(d) {\n  return __.dimensions[d].title ? __.dimensions[d].title : d;  // dimension display names\n}\n\npc.createAxes = function() {\n  if (g) pc.removeAxes();\n\n  // Add a group element for each dimension.\n  g = pc.svg.selectAll(\".dimension\")\n      .data(pc.getOrderedDimensionKeys(), function(d) {\n        return d;\n      })\n    .enter().append(\"svg:g\")\n      .attr(\"class\", \"dimension\")\n      .attr(\"transform\", function(d) {\n        return \"translate(\" + xscale(d) + \")\";\n      });\n\n  // Add an axis and title.\n  g.append(\"svg:g\")\n      .attr(\"class\", \"axis\")\n      .attr(\"transform\", \"translate(0,0)\")\n      .each(function(d) {\n        var axisElement = d3.select(this).call( pc.applyAxisConfig(axis, __.dimensions[d]) );\n\n        axisElement.selectAll(\"path\")\n            .style(\"fill\", \"none\")\n            .style(\"stroke\", \"#222\")\n            .style(\"shape-rendering\", \"crispEdges\");\n\n        axisElement.selectAll(\"line\")\n            .style(\"fill\", \"none\")\n            .style(\"stroke\", \"#222\")\n            .style(\"shape-rendering\", \"crispEdges\");\n      })\n    .append(\"svg:text\")\n      .attr({\n        \"text-anchor\": \"middle\",\n        \"y\": 0,\n        \"transform\": \"translate(0,-5) rotate(\" + __.dimensionTitleRotation + \")\",\n        \"x\": 0,\n        \"class\": \"label\"\n      })\n      .text(dimensionLabels)\n      .on(\"dblclick\", flipAxisAndUpdatePCP)\n      .on(\"wheel\", rotateLabels);\n\n  if (__.nullValueSeparator==\"top\") {\n    pc.svg.append(\"line\")\n      .attr(\"x1\", 0)\n      .attr(\"y1\", 1+__.nullValueSeparatorPadding.top)\n      .attr(\"x2\", w())\n      .attr(\"y2\", 1+__.nullValueSeparatorPadding.top)\n      .attr(\"stroke-width\", 1)\n      .attr(\"stroke\", \"#777\")\n      .attr(\"fill\", \"none\")\n      .attr(\"shape-rendering\", \"crispEdges\");\n  } else if (__.nullValueSeparator==\"bottom\") {\n    pc.svg.append(\"line\")\n      .attr(\"x1\", 0)\n      .attr(\"y1\", h()+1-__.nullValueSeparatorPadding.bottom)\n      .attr(\"x2\", w())\n      .attr(\"y2\", h()+1-__.nullValueSeparatorPadding.bottom)\n      .attr(\"stroke-width\", 1)\n      .attr(\"stroke\", \"#777\")\n      .attr(\"fill\", \"none\")\n      .attr(\"shape-rendering\", \"crispEdges\");\n  }\n\n  flags.axes= true;\n  return this;\n};\n\npc.removeAxes = function() {\n  g.remove();\n  g = undefined;\n  return this;\n};\n\npc.updateAxes = function(animationTime) {\n  if (typeof animationTime === 'undefined') {\n    animationTime = __.animationTime;\n  }\n\n  var g_data = pc.svg.selectAll(\".dimension\").data(pc.getOrderedDimensionKeys());\n\n  // Enter\n  g_data.enter().append(\"svg:g\")\n      .attr(\"class\", \"dimension\")\n      .attr(\"transform\", function(p) { return \"translate(\" + position(p) + \")\"; })\n      .style(\"opacity\", 0)\n    .append(\"svg:g\")\n      .attr(\"class\", \"axis\")\n      .attr(\"transform\", \"translate(0,0)\")\n      .each(function(d) {\n        var axisElement = d3.select(this).call( pc.applyAxisConfig(axis, __.dimensions[d]) );\n\n        axisElement.selectAll(\"path\")\n            .style(\"fill\", \"none\")\n            .style(\"stroke\", \"#222\")\n            .style(\"shape-rendering\", \"crispEdges\");\n\n        axisElement.selectAll(\"line\")\n            .style(\"fill\", \"none\")\n            .style(\"stroke\", \"#222\")\n            .style(\"shape-rendering\", \"crispEdges\");\n      })\n    .append(\"svg:text\")\n      .attr({\n        \"text-anchor\": \"middle\",\n        \"y\": 0,\n        \"transform\": \"translate(0,-5) rotate(\" + __.dimensionTitleRotation + \")\",\n        \"x\": 0,\n        \"class\": \"label\"\n      })\n      .text(dimensionLabels)\n      .on(\"dblclick\", flipAxisAndUpdatePCP)\n      .on(\"wheel\", rotateLabels);\n\n  // Update\n  g_data.attr(\"opacity\", 0);\n  g_data.select(\".axis\")\n    .transition()\n      .duration(animationTime)\n      .each(function(d) { d3.select(this).call( pc.applyAxisConfig(axis, __.dimensions[d]) )\n      });\n  g_data.select(\".label\")\n    .transition()\n      .duration(animationTime)\n      .text(dimensionLabels)\n      .attr(\"transform\", \"translate(0,-5) rotate(\" + __.dimensionTitleRotation + \")\");\n\n  // Exit\n  g_data.exit().remove();\n\n  g = pc.svg.selectAll(\".dimension\");\n  g.transition().duration(animationTime)\n    .attr(\"transform\", function(p) { return \"translate(\" + position(p) + \")\"; })\n    .style(\"opacity\", 1);\n\n  pc.svg.selectAll(\".axis\")\n    .transition()\n      .duration(animationTime)\n      .each(function(d) { d3.select(this).call( pc.applyAxisConfig(axis, __.dimensions[d]) );\n      });\n\n  if (flags.brushable) pc.brushable();\n  if (flags.reorderable) pc.reorderable();\n  if (pc.brushMode() !== \"None\") {\n    var mode = pc.brushMode();\n    pc.brushMode(\"None\");\n    pc.brushMode(mode);\n  }\n  return this;\n};\n\npc.applyAxisConfig = function(axis, dimension) {\n  return axis.scale(dimension.yscale)\n    .orient(dimension.orient)\n    .ticks(dimension.ticks)\n    .tickValues(dimension.tickValues)\n    .innerTickSize(dimension.innerTickSize)\n    .outerTickSize(dimension.outerTickSize)\n    .tickPadding(dimension.tickPadding)\n    .tickFormat(dimension.tickFormat)\n};\n\n// Jason Davies, http://bl.ocks.org/1341281\npc.reorderable = function() {\n  if (!g) pc.createAxes();\n\n  g.style(\"cursor\", \"move\")\n    .call(d3.behavior.drag()\n      .on(\"dragstart\", function(d) {\n        dragging[d] = this.__origin__ = xscale(d);\n      })\n      .on(\"drag\", function(d) {\n        dragging[d] = Math.min(w(), Math.max(0, this.__origin__ += d3.event.dx));\n        pc.sortDimensions();\n        xscale.domain(pc.getOrderedDimensionKeys());\n        pc.render();\n        g.attr(\"transform\", function(d) {\n          return \"translate(\" + position(d) + \")\";\n        });\n      })\n      .on(\"dragend\", function(d) {\n        // Let's see if the order has changed and send out an event if so.\n        var i = 0,\n            j = __.dimensions[d].index,\n            elem = this,\n            parent = this.parentElement;\n\n        while((elem = elem.previousElementSibling) != null) ++i;\n        if (i !== j) {\n          events.axesreorder.call(pc, pc.getOrderedDimensionKeys());\n          // We now also want to reorder the actual dom elements that represent\n          // the axes. That is, the g.dimension elements. If we don't do this,\n          // we get a weird and confusing transition when updateAxes is called.\n          // This is due to the fact that, initially the nth g.dimension element\n          // represents the nth axis. However, after a manual reordering,\n          // without reordering the dom elements, the nth dom elements no longer\n          // necessarily represents the nth axis.\n          //\n          // i is the original index of the dom element\n          // j is the new index of the dom element\n          if (i > j) { // Element moved left\n            parent.insertBefore(this, parent.children[j - 1]);\n          } else {     // Element moved right\n            if ((j + 1) < parent.children.length) {\n              parent.insertBefore(this, parent.children[j + 1]);\n            } else {\n              parent.appendChild(this);\n            }\n          }\n        }\n\n        delete this.__origin__;\n        delete dragging[d];\n        d3.select(this).transition().attr(\"transform\", \"translate(\" + xscale(d) + \")\");\n        pc.render();\n      }));\n  flags.reorderable = true;\n  return this;\n};\n\n// Reorder dimensions, such that the highest value (visually) is on the left and\n// the lowest on the right. Visual values are determined by the data values in\n// the given row.\npc.reorder = function(rowdata) {\n  var firstDim = pc.getOrderedDimensionKeys()[0];\n\n  pc.sortDimensionsByRowData(rowdata);\n  // NOTE: this is relatively cheap given that:\n  // number of dimensions < number of data items\n  // Thus we check equality of order to prevent rerendering when this is the case.\n  var reordered = false;\n  reordered = firstDim !== pc.getOrderedDimensionKeys()[0];\n\n  if (reordered) {\n    xscale.domain(pc.getOrderedDimensionKeys());\n    var highlighted = __.highlighted.slice(0);\n    pc.unhighlight();\n\n    g.transition()\n      .duration(1500)\n      .attr(\"transform\", function(d) {\n        return \"translate(\" + xscale(d) + \")\";\n      });\n    pc.render();\n\n    // pc.highlight() does not check whether highlighted is length zero, so we do that here.\n    if (highlighted.length !== 0) {\n      pc.highlight(highlighted);\n    }\n  }\n}\n\npc.sortDimensionsByRowData = function(rowdata) {\n  var copy = __.dimensions;\n  var positionSortedKeys = d3.keys(__.dimensions).sort(function(a, b) {\n    var pixelDifference = __.dimensions[a].yscale(rowdata[a]) - __.dimensions[b].yscale(rowdata[b]);\n\n    // Array.sort is not necessarily stable, this means that if pixelDifference is zero\n    // the ordering of dimensions might change unexpectedly. This is solved by sorting on\n    // variable name in that case.\n    if (pixelDifference === 0) {\n      return a.localeCompare(b);\n    } // else\n    return pixelDifference;\n  });\n  __.dimensions = {};\n  positionSortedKeys.forEach(function(p, i){\n    __.dimensions[p] = copy[p];\n    __.dimensions[p].index = i;\n  });\n}\n\npc.sortDimensions = function() {\n  var copy = __.dimensions;\n  var positionSortedKeys = d3.keys(__.dimensions).sort(function(a, b) {\n    return position(a) - position(b);\n  });\n  __.dimensions = {};\n  positionSortedKeys.forEach(function(p, i){\n    __.dimensions[p] = copy[p];\n    __.dimensions[p].index = i;\n  })\n};\n\n// pairs of adjacent dimensions\npc.adjacent_pairs = function(arr) {\n  var ret = [];\n  for (var i = 0; i < arr.length-1; i++) {\n    ret.push([arr[i],arr[i+1]]);\n  };\n  return ret;\n};\n\nvar brush = {\n  modes: {\n    \"None\": {\n      install: function(pc) {},            // Nothing to be done.\n      uninstall: function(pc) {},          // Nothing to be done.\n      selected: function() { return []; }, // Nothing to return\n      brushState: function() { return {}; }\n    }\n  },\n  mode: \"None\",\n  predicate: \"AND\",\n  currentMode: function() {\n    return this.modes[this.mode];\n  }\n};\n\n// This function can be used for 'live' updates of brushes. That is, during the\n// specification of a brush, this method can be called to update the view.\n//\n// @param newSelection - The new set of data items that is currently contained\n//                       by the brushes\nfunction brushUpdated(newSelection) {\n  __.brushed = newSelection;\n  events.brush.call(pc,__.brushed);\n  pc.renderBrushed();\n}\n\nfunction brushPredicate(predicate) {\n  if (!arguments.length) { return brush.predicate; }\n\n  predicate = String(predicate).toUpperCase();\n  if (predicate !== \"AND\" && predicate !== \"OR\") {\n    throw \"Invalid predicate \" + predicate;\n  }\n\n  brush.predicate = predicate;\n  __.brushed = brush.currentMode().selected();\n  pc.renderBrushed();\n  return pc;\n}\n\npc.brushModes = function() {\n  return Object.getOwnPropertyNames(brush.modes);\n};\n\npc.brushMode = function(mode) {\n  if (arguments.length === 0) {\n    return brush.mode;\n  }\n\n  if (pc.brushModes().indexOf(mode) === -1) {\n    throw \"pc.brushmode: Unsupported brush mode: \" + mode;\n  }\n\n  // Make sure that we don't trigger unnecessary events by checking if the mode\n  // actually changes.\n  if (mode !== brush.mode) {\n    // When changing brush modes, the first thing we need to do is clearing any\n    // brushes from the current mode, if any.\n    if (brush.mode !== \"None\") {\n      pc.brushReset();\n    }\n\n    // Next, we need to 'uninstall' the current brushMode.\n    brush.modes[brush.mode].uninstall(pc);\n    // Finally, we can install the requested one.\n    brush.mode = mode;\n    brush.modes[brush.mode].install();\n    if (mode === \"None\") {\n      delete pc.brushPredicate;\n    } else {\n      pc.brushPredicate = brushPredicate;\n    }\n  }\n\n  return pc;\n};\n\n// brush mode: 1D-Axes\n\n(function() {\n\tvar brushes = {};\n\n\tfunction is_brushed(p) {\n\t\treturn !brushes[p].empty();\n\t}\n\n  // data within extents\n  function selected() {\n    var actives = d3.keys(__.dimensions).filter(is_brushed),\n        extents = actives.map(function(p) { return brushes[p].extent(); });\n\n\t\t// We don't want to return the full data set when there are no axes brushed.\n\t\t// Actually, when there are no axes brushed, by definition, no items are\n\t\t// selected. So, let's avoid the filtering and just return false.\n\t\t//if (actives.length === 0) return false;\n\n\t\t// Resolves broken examples for now. They expect to get the full dataset back from empty brushes\n\t\tif (actives.length === 0) return __.data;\n\n\t\t// test if within range\n\t\tvar within = {\n\t\t\t\"date\": function(d,p,dimension) {\n\tif (typeof __.dimensions[p].yscale.rangePoints === \"function\") { // if it is ordinal\n          return extents[dimension][0] <= __.dimensions[p].yscale(d[p]) && __.dimensions[p].yscale(d[p]) <= extents[dimension][1]\n        } else {\n          return extents[dimension][0] <= d[p] && d[p] <= extents[dimension][1]\n        }\n      },\n      \"number\": function(d,p,dimension) {\n        if (typeof __.dimensions[p].yscale.rangePoints === \"function\") { // if it is ordinal\n          return extents[dimension][0] <= __.dimensions[p].yscale(d[p]) && __.dimensions[p].yscale(d[p]) <= extents[dimension][1]\n        } else {\n          return extents[dimension][0] <= d[p] && d[p] <= extents[dimension][1]\n        }\n      },\n      \"string\": function(d,p,dimension) {\n        return extents[dimension][0] <= __.dimensions[p].yscale(d[p]) && __.dimensions[p].yscale(d[p]) <= extents[dimension][1]\n      }\n    };\n\n    return __.data\n      .filter(function(d) {\n        switch(brush.predicate) {\n        case \"AND\":\n          return actives.every(function(p, dimension) {\n            return within[__.dimensions[p].type](d,p,dimension);\n          });\n        case \"OR\":\n          return actives.some(function(p, dimension) {\n            return within[__.dimensions[p].type](d,p,dimension);\n          });\n        default:\n          throw \"Unknown brush predicate \" + __.brushPredicate;\n        }\n      });\n  };\n\n  function brushExtents(extents) {\n    if(typeof(extents) === 'undefined')\n\t\t{\n\t\t\tvar extents = {};\n\t\t\td3.keys(__.dimensions).forEach(function(d) {\n\t\t\t\tvar brush = brushes[d];\n\t\t\t\tif (brush !== undefined && !brush.empty()) {\n\t\t\t\t\tvar extent = brush.extent();\n\t\t\t\t\textent.sort(d3.ascending);\n\t\t\t\t\textents[d] = extent;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn extents;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//first get all the brush selections\n\t\t\tvar brushSelections = {};\n\t\t\tg.selectAll('.brush')\n\t\t\t\t.each(function(d) {\n\t\t\t\t\tbrushSelections[d] = d3.select(this);\n\n\t\t\t});\n\n\t\t\t// loop over each dimension and update appropriately (if it was passed in through extents)\n\t\t\td3.keys(__.dimensions).forEach(function(d) {\n\t\t\t\tif (extents[d] === undefined){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar brush = brushes[d];\n\t\t\t\tif (brush !== undefined) {\n\t\t\t\t\t//update the extent\n\t\t\t\t\tbrush.extent(extents[d]);\n\n\t\t\t\t\t//redraw the brush\n\t\t\t\t\tbrushSelections[d]\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.duration(0)\n\t\t\t\t\t\t.call(brush);\n\n\t\t\t\t\t//fire some events\n\t\t\t\t\tbrush.event(brushSelections[d]);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t//redraw the chart\n\t\t\tpc.renderBrushed();\n\n\t\t\treturn pc;\n\t\t}\n  }\n\n  function brushFor(axis) {\n    var brush = d3.svg.brush();\n\n    brush\n      .y(__.dimensions[axis].yscale)\n      .on(\"brushstart\", function() {\n\t\t\t\tif(d3.event.sourceEvent !== null) {\n\t\t\t\t\tevents.brushstart.call(pc, __.brushed);\n\t\t\t\t\td3.event.sourceEvent.stopPropagation();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on(\"brush\", function() {\n\t\t\t\tbrushUpdated(selected());\n\t\t\t})\n\t\t\t.on(\"brushend\", function() {\n\t\t\t\tevents.brushend.call(pc, __.brushed);\n\t\t\t});\n\n\t\tbrushes[axis] = brush;\n\t\treturn brush;\n\t};\n\n\tfunction brushReset(dimension) {\n\t\tif (dimension===undefined) {\n\t\t\t__.brushed = false;\n\t\t\tif (g) {\n\t\t\t\tg.selectAll('.brush')\n\t\t\t\t\t.each(function(d) {\n\t\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t\t.duration(0)\n\t\t\t\t\t\t\t.call(brushes[d].clear());\n\t\t\t\t\t});\n\t\t\t\tpc.renderBrushed();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (g) {\n\t\t\t\tg.selectAll('.brush')\n\t\t\t\t\t.each(function(d) {\n\t\t\t\t\t\tif (d!=dimension) return;\n\t\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t\t.duration(0)\n\t\t\t\t\t\t\t.call(brushes[d].clear());\n\t\t\t\t\t\tbrushes[d].event(d3.select(this));\n\t\t\t\t\t});\n\t\t\t\tpc.renderBrushed();\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t};\n\n\tfunction install() {\n\t\tif (!g) pc.createAxes();\n\n\t\t// Add and store a brush for each axis.\n\t\tvar brush = g.append(\"svg:g\")\n\t\t\t.attr(\"class\", \"brush\")\n\t\t\t.each(function(d) {\n\t\t\t\td3.select(this).call(brushFor(d));\n\t\t\t});\n\n\t\tbrush.selectAll(\"rect\")\n\t\t\t\t.style(\"visibility\", null)\n\t\t\t\t.attr(\"x\", -15)\n\t\t\t\t.attr(\"width\", 30);\n\n\t\tbrush.selectAll(\"rect.background\")\n\t\t\t\t.style(\"fill\", \"transparent\");\n\n\t\tbrush.selectAll(\"rect.extent\")\n\t\t\t\t.style(\"fill\", \"rgba(255,255,255,0.25)\")\n\t\t\t\t.style(\"stroke\", \"rgba(0,0,0,0.6)\");\n\n\t\tbrush.selectAll(\".resize rect\")\n\t\t\t\t.style(\"fill\", \"rgba(0,0,0,0.1)\");\n\n\t\tpc.brushExtents = brushExtents;\n\t\tpc.brushReset = brushReset;\n\t\treturn pc;\n\t};\n\n\tbrush.modes[\"1D-axes\"] = {\n\t\tinstall: install,\n\t\tuninstall: function() {\n\t\t\tg.selectAll(\".brush\").remove();\n\t\t\tbrushes = {};\n\t\t\tdelete pc.brushExtents;\n\t\t\tdelete pc.brushReset;\n\t\t},\n\t\tselected: selected,\n\t\tbrushState: brushExtents\n\t}\n})();\n// brush mode: 2D-strums\n// bl.ocks.org/syntagmatic/5441022\n\n(function() {\n  var strums = {},\n      strumRect;\n\n  function drawStrum(strum, activePoint) {\n    var svg = pc.selection.select(\"svg\").select(\"g#strums\"),\n        id = strum.dims.i,\n        points = [strum.p1, strum.p2],\n        line = svg.selectAll(\"line#strum-\" + id).data([strum]),\n        circles = svg.selectAll(\"circle#strum-\" + id).data(points),\n        drag = d3.behavior.drag();\n\n    line.enter()\n      .append(\"line\")\n      .attr(\"id\", \"strum-\" + id)\n      .attr(\"class\", \"strum\");\n\n    line\n      .attr(\"x1\", function(d) {\n        return d.p1[0]; })\n      .attr(\"y1\", function(d) {\n        return d.p1[1]; })\n      .attr(\"x2\", function(d) {\n        return d.p2[0]; })\n      .attr(\"y2\", function(d) {\n        return d.p2[1]; })\n      .attr(\"stroke\", \"black\")\n      .attr(\"stroke-width\", 2);\n\n    drag\n      .on(\"drag\", function(d, i) { \n        var ev = d3.event;\n        i = i + 1;\n        strum[\"p\" + i][0] = Math.min(Math.max(strum.minX + 1, ev.x), strum.maxX);\n        strum[\"p\" + i][1] = Math.min(Math.max(strum.minY, ev.y), strum.maxY);\n        drawStrum(strum, i - 1);\n      })\n      .on(\"dragend\", onDragEnd());\n\n    circles.enter()\n      .append(\"circle\")\n      .attr(\"id\", \"strum-\" + id)\n      .attr(\"class\", \"strum\");\n\n    circles\n      .attr(\"cx\", function(d) { return d[0]; })\n      .attr(\"cy\", function(d) { return d[1]; })\n      .attr(\"r\", 5)\n      .style(\"opacity\", function(d, i) {\n        return (activePoint !== undefined && i === activePoint) ? 0.8 : 0;\n      })\n      .on(\"mouseover\", function() {\n        d3.select(this).style(\"opacity\", 0.8);\n      })\n      .on(\"mouseout\", function() {\n        d3.select(this).style(\"opacity\", 0);\n      })\n      .call(drag);\n  }\n\n  function dimensionsForPoint(p) {\n    var dims = { i: -1, left: undefined, right: undefined };\n    d3.keys(__.dimensions).some(function(dim, i) {\n      if (xscale(dim) < p[0]) {\n        var next = d3.keys(__.dimensions)[pc.getOrderedDimensionKeys().indexOf(dim)+1];\n        dims.i = i;\n        dims.left = dim;\n        dims.right = next;\n        return false;\n      }\n      return true;\n    });\n\n    if (dims.left === undefined) {\n      // Event on the left side of the first axis.\n      dims.i = 0;\n      dims.left = pc.getOrderedDimensionKeys()[0];\n      dims.right = pc.getOrderedDimensionKeys()[1];\n    } else if (dims.right === undefined) {\n      // Event on the right side of the last axis\n      dims.i = d3.keys(__.dimensions).length - 1;\n      dims.right = dims.left;\n      dims.left = pc.getOrderedDimensionKeys()[d3.keys(__.dimensions).length - 2];\n    }\n\n    return dims;\n  }\n\n  function onDragStart() {\n    // First we need to determine between which two axes the sturm was started.\n    // This will determine the freedom of movement, because a strum can\n    // logically only happen between two axes, so no movement outside these axes\n    // should be allowed.\n    return function() {\n      var p = d3.mouse(strumRect[0][0]),\n          dims,\n          strum;\n\n      p[0] = p[0] - __.margin.left;\n      p[1] = p[1] - __.margin.top;\n\n      dims = dimensionsForPoint(p),\n      strum = {\n        p1: p,\n        dims: dims,\n        minX: xscale(dims.left),\n        maxX: xscale(dims.right),\n        minY: 0,\n        maxY: h()\n      };\n\n      strums[dims.i] = strum;\n      strums.active = dims.i;\n\n      // Make sure that the point is within the bounds\n      strum.p1[0] = Math.min(Math.max(strum.minX, p[0]), strum.maxX);\n      strum.p2 = strum.p1.slice();\n    };\n  }\n\n  function onDrag() {\n    return function() {\n      var ev = d3.event,\n          strum = strums[strums.active];\n\n      // Make sure that the point is within the bounds\n      strum.p2[0] = Math.min(Math.max(strum.minX + 1, ev.x - __.margin.left), strum.maxX);\n      strum.p2[1] = Math.min(Math.max(strum.minY, ev.y - __.margin.top), strum.maxY);\n      drawStrum(strum, 1);\n    };\n  }\n\n  function containmentTest(strum, width) {\n    var p1 = [strum.p1[0] - strum.minX, strum.p1[1] - strum.minX],\n        p2 = [strum.p2[0] - strum.minX, strum.p2[1] - strum.minX],\n        m1 = 1 - width / p1[0],\n        b1 = p1[1] * (1 - m1),\n        m2 = 1 - width / p2[0],\n        b2 = p2[1] * (1 - m2);\n\n    // test if point falls between lines\n    return function(p) {\n      var x = p[0],\n          y = p[1],\n          y1 = m1 * x + b1,\n          y2 = m2 * x + b2;\n\n      if (y > Math.min(y1, y2) && y < Math.max(y1, y2)) {\n        return true;\n      }\n\n      return false;\n    };\n  }\n\n  function selected() {\n    var ids = Object.getOwnPropertyNames(strums),\n        brushed = __.data;\n\n    // Get the ids of the currently active strums.\n    ids = ids.filter(function(d) {\n      return !isNaN(d);\n    });\n\n    function crossesStrum(d, id) {\n      var strum = strums[id],\n          test = containmentTest(strum, strums.width(id)),\n          d1 = strum.dims.left,\n          d2 = strum.dims.right,\n          y1 = __.dimensions[d1].yscale,\n          y2 = __.dimensions[d2].yscale,\n          point = [y1(d[d1]) - strum.minX, y2(d[d2]) - strum.minX];\n      return test(point);\n    }\n\n    if (ids.length === 0) { return brushed; }\n\n    return brushed.filter(function(d) {\n      switch(brush.predicate) {\n      case \"AND\":\n        return ids.every(function(id) { return crossesStrum(d, id); });\n      case \"OR\":\n        return ids.some(function(id) { return crossesStrum(d, id); });\n      default:\n        throw \"Unknown brush predicate \" + __.brushPredicate;\n      }\n    });\n  }\n\n  function removeStrum() {\n    var strum = strums[strums.active],\n        svg = pc.selection.select(\"svg\").select(\"g#strums\");\n\n    delete strums[strums.active];\n    strums.active = undefined;\n    svg.selectAll(\"line#strum-\" + strum.dims.i).remove();\n    svg.selectAll(\"circle#strum-\" + strum.dims.i).remove();\n  }\n\n  function onDragEnd() {\n    return function() {\n      var brushed = __.data,\n          strum = strums[strums.active];\n\n      // Okay, somewhat unexpected, but not totally unsurprising, a mousclick is\n      // considered a drag without move. So we have to deal with that case\n      if (strum && strum.p1[0] === strum.p2[0] && strum.p1[1] === strum.p2[1]) {\n        removeStrum(strums);\n      }\n\n      brushed = selected(strums);\n      strums.active = undefined;\n      __.brushed = brushed;\n      pc.renderBrushed();\n      events.brushend.call(pc, __.brushed);\n    };\n  }\n\n  function brushReset(strums) {\n    return function() {\n      var ids = Object.getOwnPropertyNames(strums).filter(function(d) {\n        return !isNaN(d);\n      });\n\n      ids.forEach(function(d) {\n        strums.active = d;\n        removeStrum(strums);\n      });\n      onDragEnd(strums)();\n    };\n  }\n\n  function install() {\n    var drag = d3.behavior.drag();\n\n    // Map of current strums. Strums are stored per segment of the PC. A segment,\n    // being the area between two axes. The left most area is indexed at 0.\n    strums.active = undefined;\n    // Returns the width of the PC segment where currently a strum is being\n    // placed. NOTE: even though they are evenly spaced in our current\n    // implementation, we keep for when non-even spaced segments are supported as\n    // well.\n    strums.width = function(id) {\n      var strum = strums[id];\n\n      if (strum === undefined) {\n        return undefined;\n      }\n\n      return strum.maxX - strum.minX;\n    };\n\n    pc.on(\"axesreorder.strums\", function() {\n      var ids = Object.getOwnPropertyNames(strums).filter(function(d) {\n        return !isNaN(d);\n      });\n\n      // Checks if the first dimension is directly left of the second dimension.\n      function consecutive(first, second) {\n        var length = d3.keys(__.dimensions).length;\n        return d3.keys(__.dimensions).some(function(d, i) {\n          return (d === first)\n            ? i + i < length && __.dimensions[i + 1] === second\n            : false;\n        });\n      }\n\n      if (ids.length > 0) { // We have some strums, which might need to be removed.\n        ids.forEach(function(d) {\n          var dims = strums[d].dims;\n          strums.active = d;\n          // If the two dimensions of the current strum are not next to each other\n          // any more, than we'll need to remove the strum. Otherwise we keep it.\n          if (!consecutive(dims.left, dims.right)) {\n            removeStrum(strums);\n          }\n        });\n        onDragEnd(strums)();\n      }\n    });\n\n    // Add a new svg group in which we draw the strums.\n    pc.selection.select(\"svg\").append(\"g\")\n      .attr(\"id\", \"strums\")\n      .attr(\"transform\", \"translate(\" + __.margin.left + \",\" + __.margin.top + \")\");\n\n    // Install the required brushReset function\n    pc.brushReset = brushReset(strums);\n\n    drag\n      .on(\"dragstart\", onDragStart(strums))\n      .on(\"drag\", onDrag(strums))\n      .on(\"dragend\", onDragEnd(strums));\n\n    // NOTE: The styling needs to be done here and not in the css. This is because\n    //       for 1D brushing, the canvas layers should not listen to\n    //       pointer-events.\n    strumRect = pc.selection.select(\"svg\").insert(\"rect\", \"g#strums\")\n      .attr(\"id\", \"strum-events\")\n      .attr(\"x\", __.margin.left)\n      .attr(\"y\", __.margin.top)\n      .attr(\"width\", w())\n      .attr(\"height\", h() + 2)\n      .style(\"opacity\", 0)\n      .call(drag);\n  }\n\n  brush.modes[\"2D-strums\"] = {\n    install: install,\n    uninstall: function() {\n      pc.selection.select(\"svg\").select(\"g#strums\").remove();\n      pc.selection.select(\"svg\").select(\"rect#strum-events\").remove();\n      pc.on(\"axesreorder.strums\", undefined);\n      delete pc.brushReset;\n\n      strumRect = undefined;\n    },\n    selected: selected,\n    brushState: function () { return strums; }\n  };\n\n}());\n\n// brush mode: 1D-Axes with multiple extents\n// requires d3.svg.multibrush\n\n(function() {\n  if (typeof d3.svg.multibrush !== 'function') {\n\t  return;\n  }\n  var brushes = {};\n\n  function is_brushed(p) {\n    return !brushes[p].empty();\n  }\n\n  // data within extents\n  function selected() {\n    var actives = d3.keys(__.dimensions).filter(is_brushed),\n        extents = actives.map(function(p) { return brushes[p].extent(); });\n\n    // We don't want to return the full data set when there are no axes brushed.\n    // Actually, when there are no axes brushed, by definition, no items are\n    // selected. So, let's avoid the filtering and just return false.\n    //if (actives.length === 0) return false;\n\n    // Resolves broken examples for now. They expect to get the full dataset back from empty brushes\n    if (actives.length === 0) return __.data;\n\n    // test if within range\n    var within = {\n      \"date\": function(d,p,dimension,b) {\n        if (typeof __.dimensions[p].yscale.rangePoints === \"function\") { // if it is ordinal\n          return b[0] <= __.dimensions[p].yscale(d[p]) && __.dimensions[p].yscale(d[p]) <= b[1]\n        } else {\n            return b[0] <= d[p] && d[p] <= b[1]\n        }\n      },\n      \"number\": function(d,p,dimension,b) {\n        if (typeof __.dimensions[p].yscale.rangePoints === \"function\") { // if it is ordinal\n          return b[0] <= __.dimensions[p].yscale(d[p]) && __.dimensions[p].yscale(d[p]) <= b[1]\n        } else {\n            return b[0] <= d[p] && d[p] <= b[1]\n        }\n      },\n      \"string\": function(d,p,dimension,b) {\n        return b[0] <= __.dimensions[p].yscale(d[p]) && __.dimensions[p].yscale(d[p]) <= b[1]\n      }\n    };\n\n    return __.data\n    .filter(function(d) {\n      switch(brush.predicate) {\n      case \"AND\":\n        return actives.every(function(p, dimension) {\n          return extents[dimension].some(function(b) {\n          \treturn within[__.dimensions[p].type](d,p,dimension,b);\n          });\n        });\n      case \"OR\":\n        return actives.some(function(p, dimension) {\n      \t  return extents[dimension].some(function(b) {\n            \treturn within[__.dimensions[p].type](d,p,dimension,b);\n            });\n        });\n      default:\n        throw \"Unknown brush predicate \" + __.brushPredicate;\n      }\n    });\n  };\n\n  function brushExtents(extents) {\n    if (typeof(extents) === 'undefined') {\n      extents = {};\n      d3.keys(__.dimensions).forEach(function (d) {\n        var brush = brushes[d];\n        if (brush !== undefined && !brush.empty()) {\n          var extent = brush.extent();\n          extents[d] = extent;\n        }\n      });\n      return extents;\n    }\n    else {\n      //first get all the brush selections\n      var brushSelections = {};\n      g.selectAll('.brush')\n          .each(function (d) {\n            brushSelections[d] = d3.select(this);\n          });\n\n      // loop over each dimension and update appropriately (if it was passed in through extents)\n      d3.keys(__.dimensions).forEach(function (d) {\n        if (extents[d] === undefined) {\n          return;\n        }\n\n        var brush = brushes[d];\n        if (brush !== undefined) {\n          //update the extent\n          brush.extent(extents[d]);\n\n          //redraw the brush\n          brushSelections[d]\n              .transition()\n              .duration(0)\n              .call(brush);\n\n          //fire some events\n          brush.event(brushSelections[d]);\n        }\n      });\n\n      //redraw the chart\n      pc.renderBrushed();\n\n      return pc;\n    }\n  }\n\n  //function brushExtents() {\n  //  var extents = {};\n  //  d3.keys(__.dimensions).forEach(function(d) {\n  //    var brush = brushes[d];\n  //    if (brush !== undefined && !brush.empty()) {\n  //      var extent = brush.extent();\n  //      extents[d] = extent;\n  //    }\n  //  });\n  //  return extents;\n  //}\n\n  function brushFor(axis) {\n    var brush = d3.svg.multibrush();\n\n    brush\n      .y(__.dimensions[axis].yscale)\n      .on(\"brushstart\", function() {\n\t\t\t\tif(d3.event.sourceEvent !== null) {\n                    events.brushstart.call(pc, __.brushed);\n\t\t\t\t\td3.event.sourceEvent.stopPropagation();\n\t\t\t\t}\n      })\n      .on(\"brush\", function() {\n        brushUpdated(selected());\n      })\n      .on(\"brushend\", function() {\n    \t// d3.svg.multibrush clears extents just before calling 'brushend'\n    \t// so we have to update here again.\n    \t// This fixes issue #103 for now, but should be changed in d3.svg.multibrush\n    \t// to avoid unnecessary computation.\n    \tbrushUpdated(selected());\n        events.brushend.call(pc, __.brushed);\n      })\n      .extentAdaption(function(selection) {\n    \t  selection\n    \t  .style(\"visibility\", null)\n          .attr(\"x\", -15)\n          .attr(\"width\", 30)\n          .style(\"fill\", \"rgba(255,255,255,0.25)\")\n          .style(\"stroke\", \"rgba(0,0,0,0.6)\");\n      })\n      .resizeAdaption(function(selection) {\n    \t selection\n    \t   .selectAll(\"rect\")\n    \t   .attr(\"x\", -15)\n    \t   .attr(\"width\", 30)\n         .style(\"visibility\", null)\n         .style(\"fill\", \"rgba(0,0,0,0.1)\");\n      });\n\n    brushes[axis] = brush;\n    return brush;\n  }\n\n  function brushReset(dimension) {\n    __.brushed = false;\n    if (g) {\n      g.selectAll('.brush')\n        .each(function(d) {\n          d3.select(this).call(\n            brushes[d].clear()\n          );\n        });\n      pc.renderBrushed();\n    }\n    return this;\n  };\n\n  function install() {\n    if (!g) pc.createAxes();\n\n    // Add and store a brush for each axis.\n    var brush = g.append(\"svg:g\")\n      .attr(\"class\", \"brush\")\n      .each(function(d) {\n        d3.select(this).call(brushFor(d));\n      })\n\n    brush.selectAll(\"rect\")\n        .style(\"visibility\", null)\n        .attr(\"x\", -15)\n        .attr(\"width\", 30);\n\n    brush.selectAll(\"rect.background\")\n        .style(\"fill\", \"transparent\");\n\n    brush.selectAll(\"rect.extent\")\n        .style(\"fill\", \"rgba(255,255,255,0.25)\")\n        .style(\"stroke\", \"rgba(0,0,0,0.6)\");\n\n    brush.selectAll(\".resize rect\")\n        .style(\"fill\", \"rgba(0,0,0,0.1)\");\n\n    pc.brushExtents = brushExtents;\n    pc.brushReset = brushReset;\n    return pc;\n  }\n\n  brush.modes[\"1D-axes-multi\"] = {\n    install: install,\n    uninstall: function() {\n      g.selectAll(\".brush\").remove();\n      brushes = {};\n      delete pc.brushExtents;\n      delete pc.brushReset;\n    },\n    selected: selected,\n    brushState: brushExtents\n  }\n})();\n// brush mode: angular\n// code based on 2D.strums.js\n\n(function() {\n  var arcs = {},\n      strumRect;\n\n  function drawStrum(arc, activePoint) {\n    var svg = pc.selection.select(\"svg\").select(\"g#arcs\"),\n        id = arc.dims.i,\n        points = [arc.p2, arc.p3],\n        line = svg.selectAll(\"line#arc-\" + id).data([{p1:arc.p1,p2:arc.p2},{p1:arc.p1,p2:arc.p3}]),\n        circles = svg.selectAll(\"circle#arc-\" + id).data(points),\n        drag = d3.behavior.drag(),\n        path = svg.selectAll(\"path#arc-\" + id).data([arc]);\n\n    path.enter()\n      .append(\"path\")\n      .attr(\"id\", \"arc-\" + id)\n      .attr(\"class\", \"arc\")\n      .style(\"fill\", \"orange\")\n      .style(\"opacity\", 0.5);\n\n    path\n      .attr(\"d\", arc.arc)\n      .attr(\"transform\", \"translate(\" + arc.p1[0] + \",\" + arc.p1[1] + \")\");\n\n    line.enter()\n      .append(\"line\")\n      .attr(\"id\", \"arc-\" + id)\n      .attr(\"class\", \"arc\");\n\n    line\n      .attr(\"x1\", function(d) { return d.p1[0]; })\n      .attr(\"y1\", function(d) { return d.p1[1]; })\n      .attr(\"x2\", function(d) { return d.p2[0]; })\n      .attr(\"y2\", function(d) { return d.p2[1]; })\n      .attr(\"stroke\", \"black\")\n      .attr(\"stroke-width\", 2);\n\n    drag\n      .on(\"drag\", function(d, i) {\n        var ev = d3.event,\n        \tangle = 0;\n\n        i = i + 2;\n\n        arc[\"p\" + i][0] = Math.min(Math.max(arc.minX + 1, ev.x), arc.maxX);\n        arc[\"p\" + i][1] = Math.min(Math.max(arc.minY, ev.y), arc.maxY);\n\n        angle = i === 3 ? arcs.startAngle(id) : arcs.endAngle(id);\n\n        if ((arc.startAngle < Math.PI && arc.endAngle < Math.PI && angle < Math.PI) ||\n        \t\t(arc.startAngle >= Math.PI && arc.endAngle >= Math.PI && angle >= Math.PI)) {\n\n        \tif (i === 2) {\n\t        \tarc.endAngle = angle;\n\t        \tarc.arc.endAngle(angle);\n\t        } else if (i === 3) {\n\t        \tarc.startAngle = angle;\n\t        \tarc.arc.startAngle(angle);\n\t        }\n\n        }\n\n        drawStrum(arc, i - 2);\n      })\n      .on(\"dragend\", onDragEnd());\n\n    circles.enter()\n      .append(\"circle\")\n      .attr(\"id\", \"arc-\" + id)\n      .attr(\"class\", \"arc\");\n\n    circles\n      .attr(\"cx\", function(d) { return d[0]; })\n      .attr(\"cy\", function(d) { return d[1]; })\n      .attr(\"r\", 5)\n      .style(\"opacity\", function(d, i) {\n        return (activePoint !== undefined && i === activePoint) ? 0.8 : 0;\n      })\n      .on(\"mouseover\", function() {\n        d3.select(this).style(\"opacity\", 0.8);\n      })\n      .on(\"mouseout\", function() {\n        d3.select(this).style(\"opacity\", 0);\n      })\n      .call(drag);\n  }\n\n  function dimensionsForPoint(p) {\n    var dims = { i: -1, left: undefined, right: undefined };\n    d3.keys(__.dimensions).some(function(dim, i) {\n      if (xscale(dim) < p[0]) {\n        var next = d3.keys(__.dimensions)[pc.getOrderedDimensionKeys().indexOf(dim)+1];\n        dims.i = i;\n        dims.left = dim;\n        dims.right = next;\n        return false;\n      }\n      return true;\n    });\n\n    if (dims.left === undefined) {\n      // Event on the left side of the first axis.\n      dims.i = 0;\n      dims.left = pc.getOrderedDimensionKeys()[0];\n      dims.right = pc.getOrderedDimensionKeys()[1];\n    } else if (dims.right === undefined) {\n      // Event on the right side of the last axis\n      dims.i = d3.keys(__.dimensions).length - 1;\n      dims.right = dims.left;\n      dims.left = pc.getOrderedDimensionKeys()[d3.keys(__.dimensions).length - 2];\n    }\n\n    return dims;\n  }\n\n  function onDragStart() {\n    // First we need to determine between which two axes the arc was started.\n    // This will determine the freedom of movement, because a arc can\n    // logically only happen between two axes, so no movement outside these axes\n    // should be allowed.\n    return function() {\n      var p = d3.mouse(strumRect[0][0]),\n          dims,\n          arc;\n\n      p[0] = p[0] - __.margin.left;\n      p[1] = p[1] - __.margin.top;\n\n      dims = dimensionsForPoint(p),\n      arc = {\n        p1: p,\n        dims: dims,\n        minX: xscale(dims.left),\n        maxX: xscale(dims.right),\n        minY: 0,\n        maxY: h(),\n        startAngle: undefined,\n        endAngle: undefined,\n        arc: d3.svg.arc().innerRadius(0)\n      };\n\n      arcs[dims.i] = arc;\n      arcs.active = dims.i;\n\n      // Make sure that the point is within the bounds\n      arc.p1[0] = Math.min(Math.max(arc.minX, p[0]), arc.maxX);\n      arc.p2 = arc.p1.slice();\n      arc.p3 = arc.p1.slice();\n    };\n  }\n\n  function onDrag() {\n    return function() {\n      var ev = d3.event,\n          arc = arcs[arcs.active];\n\n      // Make sure that the point is within the bounds\n      arc.p2[0] = Math.min(Math.max(arc.minX + 1, ev.x - __.margin.left), arc.maxX);\n      arc.p2[1] = Math.min(Math.max(arc.minY, ev.y - __.margin.top), arc.maxY);\n      arc.p3 = arc.p2.slice();\n//      console.log(arcs.angle(arcs.active));\n//      console.log(signedAngle(arcs.unsignedAngle(arcs.active)));\n      drawStrum(arc, 1);\n    };\n  }\n\n  // some helper functions\n  function hypothenuse(a, b) {\n\t  return Math.sqrt(a*a + b*b);\n  }\n\n  var rad = (function() {\n\t  var c = Math.PI / 180;\n\t  return function(angle) {\n\t\t  return angle * c;\n\t  };\n  })();\n\n  var deg = (function() {\n\t  var c = 180 / Math.PI;\n\t  return function(angle) {\n\t\t  return angle * c;\n\t  };\n  })();\n\n  // [0, 2*PI] -> [-PI/2, PI/2]\n  var signedAngle = function(angle) {\n    var ret = angle;\n    if (angle > Math.PI) {\n      ret = angle - 1.5 * Math.PI;\n      ret = angle - 1.5 * Math.PI;\n    } else {\n      ret = angle - 0.5 * Math.PI;\n      ret = angle - 0.5 * Math.PI;\n    }\n    return -ret;\n  }\n\n  /**\n   * angles are stored in radians from in [0, 2*PI], where 0 in 12 o'clock.\n   * However, one can only select lines from 0 to PI, so we compute the\n   * 'signed' angle, where 0 is the horizontal line (3 o'clock), and +/- PI/2\n   * are 12 and 6 o'clock respectively.\n   */\n  function containmentTest(arc) {\n    var startAngle = signedAngle(arc.startAngle);\n    var endAngle = signedAngle(arc.endAngle);\n\n    if (startAngle > endAngle) {\n    \tvar tmp = startAngle;\n    \tstartAngle = endAngle;\n    \tendAngle = tmp;\n    }\n\n    // test if segment angle is contained in angle interval\n    return function(a) {\n\n      if (a >= startAngle && a <= endAngle) {\n        return true;\n      }\n\n      return false;\n    };\n  }\n\n  function selected() {\n    var ids = Object.getOwnPropertyNames(arcs),\n        brushed = __.data;\n\n    // Get the ids of the currently active arcs.\n    ids = ids.filter(function(d) {\n      return !isNaN(d);\n    });\n\n    function crossesStrum(d, id) {\n      var arc = arcs[id],\n          test = containmentTest(arc),\n          d1 = arc.dims.left,\n          d2 = arc.dims.right,\n          y1 = __.dimensions[d1].yscale,\n          y2 = __.dimensions[d2].yscale,\n          a = arcs.width(id),\n          b = y1(d[d1]) - y2(d[d2]),\n          c = hypothenuse(a, b),\n          angle = Math.asin(b/c);\t// rad in [-PI/2, PI/2]\n      return test(angle);\n    }\n\n    if (ids.length === 0) { return brushed; }\n\n    return brushed.filter(function(d) {\n      switch(brush.predicate) {\n      case \"AND\":\n        return ids.every(function(id) { return crossesStrum(d, id); });\n      case \"OR\":\n        return ids.some(function(id) { return crossesStrum(d, id); });\n      default:\n        throw \"Unknown brush predicate \" + __.brushPredicate;\n      }\n    });\n  }\n\n  function removeStrum() {\n    var arc = arcs[arcs.active],\n        svg = pc.selection.select(\"svg\").select(\"g#arcs\");\n\n    delete arcs[arcs.active];\n    arcs.active = undefined;\n    svg.selectAll(\"line#arc-\" + arc.dims.i).remove();\n    svg.selectAll(\"circle#arc-\" + arc.dims.i).remove();\n    svg.selectAll(\"path#arc-\" + arc.dims.i).remove();\n  }\n\n  function onDragEnd() {\n    return function() {\n      var brushed = __.data,\n          arc = arcs[arcs.active];\n\n      // Okay, somewhat unexpected, but not totally unsurprising, a mousclick is\n      // considered a drag without move. So we have to deal with that case\n      if (arc && arc.p1[0] === arc.p2[0] && arc.p1[1] === arc.p2[1]) {\n        removeStrum(arcs);\n      }\n\n      if (arc) {\n    \t  var angle = arcs.startAngle(arcs.active);\n\n    \t  arc.startAngle = angle;\n          arc.endAngle = angle;\n          arc.arc\n            .outerRadius(arcs.length(arcs.active))\n            .startAngle(angle)\n            .endAngle(angle);\n      }\n\n\n      brushed = selected(arcs);\n      arcs.active = undefined;\n      __.brushed = brushed;\n      pc.renderBrushed();\n      events.brushend.call(pc, __.brushed);\n    };\n  }\n\n  function brushReset(arcs) {\n    return function() {\n      var ids = Object.getOwnPropertyNames(arcs).filter(function(d) {\n        return !isNaN(d);\n      });\n\n      ids.forEach(function(d) {\n        arcs.active = d;\n        removeStrum(arcs);\n      });\n      onDragEnd(arcs)();\n    };\n  }\n\n  function install() {\n    var drag = d3.behavior.drag();\n\n    // Map of current arcs. arcs are stored per segment of the PC. A segment,\n    // being the area between two axes. The left most area is indexed at 0.\n    arcs.active = undefined;\n    // Returns the width of the PC segment where currently a arc is being\n    // placed. NOTE: even though they are evenly spaced in our current\n    // implementation, we keep for when non-even spaced segments are supported as\n    // well.\n    arcs.width = function(id) {\n      var arc = arcs[id];\n\n      if (arc === undefined) {\n        return undefined;\n      }\n\n      return arc.maxX - arc.minX;\n    };\n\n    // returns angles in [-PI/2, PI/2]\n    angle = function(p1, p2) {\n        var a = p1[0] - p2[0],\n        \tb = p1[1] - p2[1],\n        \tc = hypothenuse(a, b);\n\n        return Math.asin(b/c);\n    }\n\n    // returns angles in [0, 2 * PI]\n    arcs.endAngle = function(id) {\n    \tvar arc = arcs[id];\n    \tif (arc === undefined) {\n            return undefined;\n        }\n    \tvar sAngle = angle(arc.p1, arc.p2),\n    \t\tuAngle = -sAngle + Math.PI / 2;\n\n    \tif (arc.p1[0] > arc.p2[0]) {\n    \t\tuAngle = 2 * Math.PI - uAngle;\n    \t}\n\n    \treturn uAngle;\n    }\n\n    arcs.startAngle = function(id) {\n    \tvar arc = arcs[id];\n    \tif (arc === undefined) {\n            return undefined;\n        }\n\n    \tvar sAngle = angle(arc.p1, arc.p3),\n    \t\tuAngle = -sAngle + Math.PI / 2;\n\n    \tif (arc.p1[0] > arc.p3[0]) {\n    \t\tuAngle = 2 * Math.PI - uAngle;\n    \t}\n\n    \treturn uAngle;\n    }\n\n    arcs.length = function(id) {\n    \tvar arc = arcs[id];\n\n        if (arc === undefined) {\n          return undefined;\n        }\n\n        var a = arc.p1[0] - arc.p2[0],\n        \tb = arc.p1[1] - arc.p2[1],\n        \tc = hypothenuse(a, b);\n\n        return(c);\n    }\n\n    pc.on(\"axesreorder.arcs\", function() {\n      var ids = Object.getOwnPropertyNames(arcs).filter(function(d) {\n        return !isNaN(d);\n      });\n\n      // Checks if the first dimension is directly left of the second dimension.\n      function consecutive(first, second) {\n        var length = d3.keys(__.dimensions).length;\n        return d3.keys(__.dimensions).some(function(d, i) {\n          return (d === first)\n            ? i + i < length && __.dimensions[i + 1] === second\n            : false;\n        });\n      }\n\n      if (ids.length > 0) { // We have some arcs, which might need to be removed.\n        ids.forEach(function(d) {\n          var dims = arcs[d].dims;\n          arcs.active = d;\n          // If the two dimensions of the current arc are not next to each other\n          // any more, than we'll need to remove the arc. Otherwise we keep it.\n          if (!consecutive(dims.left, dims.right)) {\n            removeStrum(arcs);\n          }\n        });\n        onDragEnd(arcs)();\n      }\n    });\n\n    // Add a new svg group in which we draw the arcs.\n    pc.selection.select(\"svg\").append(\"g\")\n      .attr(\"id\", \"arcs\")\n      .attr(\"transform\", \"translate(\" + __.margin.left + \",\" + __.margin.top + \")\");\n\n    // Install the required brushReset function\n    pc.brushReset = brushReset(arcs);\n\n    drag\n      .on(\"dragstart\", onDragStart(arcs))\n      .on(\"drag\", onDrag(arcs))\n      .on(\"dragend\", onDragEnd(arcs));\n\n    // NOTE: The styling needs to be done here and not in the css. This is because\n    //       for 1D brushing, the canvas layers should not listen to\n    //       pointer-events.\n    strumRect = pc.selection.select(\"svg\").insert(\"rect\", \"g#arcs\")\n      .attr(\"id\", \"arc-events\")\n      .attr(\"x\", __.margin.left)\n      .attr(\"y\", __.margin.top)\n      .attr(\"width\", w())\n      .attr(\"height\", h() + 2)\n      .style(\"opacity\", 0)\n      .call(drag);\n  }\n\n  brush.modes[\"angular\"] = {\n    install: install,\n    uninstall: function() {\n      pc.selection.select(\"svg\").select(\"g#arcs\").remove();\n      pc.selection.select(\"svg\").select(\"rect#arc-events\").remove();\n      pc.on(\"axesreorder.arcs\", undefined);\n      delete pc.brushReset;\n\n      strumRect = undefined;\n    },\n    selected: selected,\n    brushState: function () { return arcs; }\n  };\n\n}());\npc.interactive = function() {\n  flags.interactive = true;\n  return this;\n};\n\n// expose a few objects\npc.xscale = xscale;\npc.ctx = ctx;\npc.canvas = canvas;\npc.g = function() { return g; };\n\n// rescale for height, width and margins\n// TODO currently assumes chart is brushable, and destroys old brushes\npc.resize = function() {\n  // selection size\n  pc.selection.select(\"svg\")\n    .attr(\"width\", __.width)\n    .attr(\"height\", __.height)\n  pc.svg.attr(\"transform\", \"translate(\" + __.margin.left + \",\" + __.margin.top + \")\");\n\n  // FIXME: the current brush state should pass through\n  if (flags.brushable) pc.brushReset();\n\n  // scales\n  pc.autoscale();\n\n  // axes, destroys old brushes.\n  if (g) pc.createAxes();\n  if (flags.brushable) pc.brushable();\n  if (flags.reorderable) pc.reorderable();\n\n  events.resize.call(this, {width: __.width, height: __.height, margin: __.margin});\n  return this;\n};\n\n// highlight an array of data\npc.highlight = function(data) {\n  if (arguments.length === 0) {\n    return __.highlighted;\n  }\n\n  __.highlighted = data;\n  pc.clear(\"highlight\");\n  d3.selectAll([canvas.foreground, canvas.brushed]).classed(\"faded\", true);\n  data.forEach(path_highlight);\n  events.highlight.call(this, data);\n  return this;\n};\n\n// clear highlighting\npc.unhighlight = function() {\n  __.highlighted = [];\n  pc.clear(\"highlight\");\n  d3.selectAll([canvas.foreground, canvas.brushed]).classed(\"faded\", false);\n  return this;\n};\n\n// calculate 2d intersection of line a->b with line c->d\n// points are objects with x and y properties\npc.intersection =  function(a, b, c, d) {\n  return {\n    x: ((a.x * b.y - a.y * b.x) * (c.x - d.x) - (a.x - b.x) * (c.x * d.y - c.y * d.x)) / ((a.x - b.x) * (c.y - d.y) - (a.y - b.y) * (c.x - d.x)),\n    y: ((a.x * b.y - a.y * b.x) * (c.y - d.y) - (a.y - b.y) * (c.x * d.y - c.y * d.x)) / ((a.x - b.x) * (c.y - d.y) - (a.y - b.y) * (c.x - d.x))\n  };\n};\n\nfunction position(d) {\n  if (xscale.range().length === 0) {\n    xscale.rangePoints([0, w()], 1);\n  }\n  var v = dragging[d];\n  return v == null ? xscale(d) : v;\n}\n\n// Merges the canvases and SVG elements into one canvas element which is then passed into the callback\n// (so you can choose to save it to disk, etc.)\npc.mergeParcoords = function(callback) {\n  // Retina display, etc.\n  var devicePixelRatio = window.devicePixelRatio || 1;\n\n  // Create a canvas element to store the merged canvases\n  var mergedCanvas = document.createElement(\"canvas\");\n  mergedCanvas.width = pc.canvas.foreground.clientWidth * devicePixelRatio\n  mergedCanvas.height = (pc.canvas.foreground.clientHeight + 30) * devicePixelRatio;\n  mergedCanvas.style.width = mergedCanvas.width / devicePixelRatio + \"px\";\n  mergedCanvas.style.height = mergedCanvas.height / devicePixelRatio + \"px\";\n\n  // Give the canvas a white background\n  var context = mergedCanvas.getContext(\"2d\");\n  context.fillStyle = \"#ffffff\";\n  context.fillRect(0, 0, mergedCanvas.width, mergedCanvas.height);\n\n  // Merge all the canvases\n  for (var key in pc.canvas) {\n    context.drawImage(pc.canvas[key], 0, 24 * devicePixelRatio, mergedCanvas.width, mergedCanvas.height - 30 * devicePixelRatio);\n  }\n\n  // Add SVG elements to canvas\n  var DOMURL = window.URL || window.webkitURL || window;\n  var serializer = new XMLSerializer();\n  var svgStr = serializer.serializeToString(pc.selection.select(\"svg\")[0][0]);\n\n  // Create a Data URI.\n  var src = 'data:image/svg+xml;base64,' + window.btoa(svgStr);\n  var img = new Image();\n  img.onload = function () {\n    context.drawImage(img, 0, 0, img.width * devicePixelRatio, img.height * devicePixelRatio);\n    if (typeof callback === \"function\") {\n      callback(mergedCanvas);\n    }\n  };\n  img.src = src;\n}\npc.version = \"0.7.0\";\n  // this descriptive text should live with other introspective methods\n  pc.toString = function() { return \"Parallel Coordinates: \" + d3.keys(__.dimensions).length + \" dimensions (\" + d3.keys(__.data[0]).length + \" total) , \" + __.data.length + \" rows\"; };\n\n  return pc;\n};\n\nd3.renderQueue = (function(func) {\n  var _queue = [],                  // data to be rendered\n      _rate = 10,                   // number of calls per frame\n      _clear = function() {},       // clearing function\n      _i = 0;                       // current iteration\n\n  var rq = function(data) {\n    if (data) rq.data(data);\n    rq.invalidate();\n    _clear();\n    rq.render();\n  };\n\n  rq.render = function() {\n    _i = 0;\n    var valid = true;\n    rq.invalidate = function() { valid = false; };\n\n    function doFrame() {\n      if (!valid) return true;\n      if (_i > _queue.length) return true;\n\n      // Typical d3 behavior is to pass a data item *and* its index. As the\n      // render queue splits the original data set, we'll have to be slightly\n      // more carefull about passing the correct index with the data item.\n      var end = Math.min(_i + _rate, _queue.length);\n      for (var i = _i; i < end; i++) {\n        func(_queue[i], i);\n      }\n      _i += _rate;\n    }\n\n    d3.timer(doFrame);\n  };\n\n  rq.data = function(data) {\n    rq.invalidate();\n    _queue = data.slice(0);\n    return rq;\n  };\n\n  rq.rate = function(value) {\n    if (!arguments.length) return _rate;\n    _rate = value;\n    return rq;\n  };\n\n  rq.remaining = function() {\n    return _queue.length - _i;\n  };\n\n  // clear the canvas\n  rq.clear = function(func) {\n    if (!arguments.length) {\n      _clear();\n      return rq;\n    }\n    _clear = func;\n    return rq;\n  };\n\n  rq.invalidate = function() {};\n\n  return rq;\n});\n"]}